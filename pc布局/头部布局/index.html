<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
<!--外部容器-->
<div class="wrap">
	<!-- 开机动画 遮罩层 -->
	<div id="mask">
		<div class="maskTop"></div>
		<div class="maskBottom"></div>
		<span class="maskLine"></span>
	</div>
	<!-- 头部 -->
	<header id="header">
		<!-- 头部内部容器 -->
		<section class="headerMain">
			<!-- logo -->
			<h1 class="logo">
				<a href="javascript:;"><img src="img/logo.png" alt=""></a>
			</h1>
			<!-- nav导航 -->
			<nav class="nav">
				<ul>
					<li>
						<a href="javascript:;">
							<div class="up"><img src="img/home_gruen.png" alt=""></div>
							<div class="down"><img src="img/home.png" alt=""></div>
						</a>
					</li>
					<li>
						<a href="javascript:;">
							<div class="up">Course</div>
							<div class="down">Course</div>
						</a>
					</li>
					<li>
						<a href="javascript:;">
							<div class="up">Works</div>
							<div class="down">Works</div>
						</a>
					</li>
					<li>
						<a href="javascript:;">
							<div class="up">About</div>
							<div class="down">About</div>
						</a>
					</li>
					<li>
						<a href="javascript:;">
							<div class="up">Team</div>
							<div class="down">Team</div>
						</a>
					</li>
				</ul>
			</nav>
		</section>
		<div class="arrow"></div>
	</header>
	<section id="content">
		<!-- 侧边导航 -->
		<ul class="menuBar">
			<li class="active"></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
		</ul>
		
		<ul class="list">
			<li><div class="home">
					<ul class="homeList">
						<li class="active">
							<div class="commonTitle">first floor</div>
						</li>
						<li class="">
							<div class="commonTitle">second floor</div>
						</li>
						<li>
							<div class="commonTitle">third floor</div>
						</li>
						<li>
							<div class="commonTitle">forth floor</div>
						</li>
						
					</ul>
					<ul class="homeIcon">
						<li class="active"></li>
						<li></li>
						<li></li>
						<li></li>
					</ul>
				<!-- <header class="home1">
					<h2 class="commonTitle">
						<span>EINBLICK</span><br>
						<span>ERKENNTNIS</span><br>
						<span>ERGEBNIS</span>
					</h2>
				</header> -->
			</div></li>
			<li><div class="course">
				<header class="course1">
					<h2 class="commonTitle">
						<span>EINIGE</span><br>
						<span>UNSERER</span><br>
						<span>KUNDEN</span>
					</h2>
				</header>
				<div class="course2">
					<p>Das Kundenvertrauen in unsere Kompetenz ist die notwendige Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber auch das größte Lob, das man uns entgegenbringen kann.</p>
<p>Diese und viele weitere große und kleine Kunden vertrauen uns seit Jahren, was uns stolz macht, und dafür sagen wir an dieser Stelle einfach mal.</p>
				</div>
				<div class="course3">
					<div class="line"></div>
					<div class="line"></div>
					<div class="line"></div>
					<div class="line"></div>
					<div class="line"></div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					<div class="item">
						<div class="itemInner">
							<div class="front"></div>
							<div class="back">今天天气真不错</div>
						</div>
					</div>
					
				</div>
				<div class="plane1"></div>
				<div class="plane2"></div>
				<div class="plane3"></div>
			</div></li>
			<li><div class="works">
				<header class="works1">
					<h2 class="commonTitle">
						<span>EINBLICK</span><br>
						<span>ERKENNTNIS</span><br>
						<span>ERGEBNIS</span>
					</h2>
				</header>
				<div class="works2">
					<div class="item">
						<img src="img/worksimg1.jpg" >
						<div class="mask">
							在我的后花园
							<div class="icon"></div>
						</div>
					</div>
					<div class="item">
						<img src="img/worksimg2.jpg" >
						<div class="mask">
							在我的后花园
							<div class="icon"></div>
						</div>
					</div>
					<div class="item">
						<img src="img/worksimg3.jpg" >
						<div class="mask">
							在我的后花园
							<div class="icon"></div>
						</div>
					</div>
					<div class="item">
						<img src="img/worksimg4.jpg" >
						<div class="mask">
							在我的后花园
							<div class="icon"></div>
						</div>
					</div>
				</div>
				<div class="works3">
					
				</div>
				<div class="pencel1"></div>
				<div class="pencel2"></div>
				<div class="pencel3"></div>
			</div></li>
			<li><div class="about">
				<header class="about1">
					<h2 class="commonTitle">
						<span>DIE</span><br>
						<span>SPEZIELLE</span><br>
						<span>VIELFALT</span>
					</h2>
				</header>
				<div class="about2">
					<p>Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.</p>
				</div>
				<div class="about3">
					<div class="item">
						<span></span>
						<ul data-src="img/about1.jpg">
							
						</ul>
					</div>
					<div class="item">
						<span></span>
						<ul data-src="img/about3.jpg">
							
						</ul>
					</div>
				</div>
				<div class="pencel1"></div>
				<div class="pencel2"></div>
				<div class="pencel3"></div>
			</div></li>
			<li><div class="team">
				<header class="team1">
					<h2 class="commonTitle">
						<span>WIR SIND</span><br>
						<span>VOXELAIR</span><br>
					</h2>
				</header>
				<div class="team2">
					<p>Wir sind seit 2002 eine Full-Service-Werbeagentur mit Stammsitz in Heimsheim, zwischen Stuttgart und Karlsruhe.</p>
					<p>Über 60 Jahre Erfahrung vereinen das gesamte VoxelAir-Team. Dabei hat jedes Voxel neben professionellem Allroundwissen auch sein ganz spezielles Gebiet, um selbst die individuellsten Kundenwünsche schnell und kompetent umzusetzen.</p>
					
				</div>
				<ul class="team3">
					<li></li>
					<li></li>
					<li></li>
					<li></li>
				</ul>
			</div></li>
		</ul>
	</section>
</div>
<script type="text/javascript">
	window.onload = function(){
		var arrow = document.querySelector('#header .arrow');
		var liNodes = document.querySelectorAll('#header .headerMain .nav ul li');
		var upNodes = document.querySelectorAll('#header .headerMain .nav ul li .up');
		
		var content = document.getElementById('content');
		var header = document.getElementById('header');
		var contentLi = document.querySelectorAll('#content .list>li');
		var contentList = document.querySelector('#content .list');
		
		var now = 0;
		var preIndex = 0;
		
		var aboutUl = document.querySelectorAll('#content .list .about .about3>.item>ul');
		
		// 第一屏
		var home1Li = document.querySelectorAll("#content .list .home .homeList>li");
		var home2Li = document.querySelectorAll('#content .list .home .homeIcon>li');
		
		// 开机动画
		var maskLine =document.querySelector('#mask .maskLine');
		var maskTop =document.querySelector('#mask .maskTop');
		var maskBottom =document.querySelector('#mask .maskBottom');
		var mask = document.querySelector('#mask');
		
		// 开机动画
		function loading(){
			// 创建加载完成的图片计数器，记录当前加载完成的图片的数量
			var imgFlag = 0;
			// 图片路径储存数组
			var arr = ['bg1.jpg','bg2.jpg','bg3.jpg','bg4.jpg','bg5.jpg','about1.jpg','about2.jpg','about3.jpg','about4.jpg','worksimg1.jpg','worksimg2.jpg','worksimg3.jpg','worksimg4.jpg','team.png','greenLine.png'];
			for(var i = 0; i < arr.length; i++){
				// 创建图片对象  相当于创建了一个图片标签
				var imgNode = new Image();
				// 给图片标签加路径，图片标签拿到路径之后就会开始加载图片
				imgNode.src = 'img/' + arr[i];
				// 图片加载完成之后执行的操作
				imgNode.onload = function(){
					imgFlag++;
					maskLine.style.width = imgFlag/arr.length*100 + '%';
					console.log(maskLine.style.width);
				}
				
			}
			// 添加事件监听完成事件,启动开场动画
			maskLine.addEventListener('transitionend',function(){
				maskTop.style.height = '0';
				maskBottom.style.height = '0';
				maskLine.style.display = 'none';
			});
			// 监听开场动画过渡完成之后，开启第一屏的入场动画
			maskTop.addEventListener('transitionend',function(){
				// 第一页入场动画
				animationArr[0]['inAin']();
				// 第一页入场动画结束之后开始执行home3D()
				home3D();
				// 入场动画结束之后将mask删掉
				mask.remove();
			});
		}
		loading();
		
		// 入场动画
		var animationArr = [{
			// 第一屏入场动画
			inAin:function(){
				var homeList = document.querySelector('#content .list .home .homeList');
				var homeIcon = document.querySelector('#content .list .home .homeIcon');
				
				homeList.style.transform = 'translateY(0)';
				homeIcon.style.transform = 'translateY(0)';
				homeList.style.opacity = '1';
				homeIcon.style.opacity = '1';
			},
			// 第一屏出场动画
			outAin:function(){
				var homeList = document.querySelector('#content .list .home .homeList');
				var homeIcon = document.querySelector('#content .list .home .homeIcon');
				
				homeList.style.transform = 'translateY(-200px)';
				homeIcon.style.transform = 'translateY(200px)';
				homeList.style.opacity = '0';
				homeIcon.style.opacity = '0';
			},
			
		},{
			// 第二屏出场动画
			inAin:function(){
				var plane1 = document.querySelector('#content .list .course .plane1');
				var plane2 = document.querySelector('#content .list .course .plane2');
				var plane3 = document.querySelector('#content .list .course .plane3');
				
				plane1.style.transform = 'translate(0,0)';
				plane2.style.transform = 'translate(0,0)';
				plane3.style.transform = 'translate(0,0)';
			},
			// 第二屏入场动画
			outAin:function(){
				var plane1 = document.querySelector('#content .list .course .plane1');
				var plane2 = document.querySelector('#content .list .course .plane2');
				var plane3 = document.querySelector('#content .list .course .plane3');
				
				plane1.style.transform = 'translate(-200px,-200px)';
				plane2.style.transform = 'translate(-200px,200px)';
				plane3.style.transform = 'translate(200px,-200px)';
			}
		},{
			// 第三屏入场动画
			inAin:function(){
				var pencel1 = document.querySelector('#content .list .works .pencel1');
				var pencel2 = document.querySelector('#content .list .works .pencel2');
				var pencel3 = document.querySelector('#content .list .works .pencel3');
				
				pencel1.style.transform = 'translateY(0)';
				pencel2.style.transform = 'translateY(0)';
				pencel3.style.transform = 'translateY(0)';
			},
			// 第三屏出场动画
			outAin:function(){
				var pencel1 = document.querySelector('#content .list .works .pencel1');
				var pencel2 = document.querySelector('#content .list .works .pencel2');
				var pencel3 = document.querySelector('#content .list .works .pencel3');
				
				pencel1.style.transform = 'translateY(-200px)';
				pencel2.style.transform = 'translateY(200px)';
				pencel3.style.transform = 'translateY(200px)';
			}
		},{
			// 第四屏入场动画
			inAin:function(){
				var aboutItem1 = document.querySelector('#content .list .about .about3>.item:nth-child(1)');
				var aboutItem2 = document.querySelector('#content .list .about .about3>.item:nth-child(2)');
				
				aboutItem1.style.transform = 'rotateZ(0deg)';
				aboutItem2.style.transform = 'rotateZ(0deg)';
			},
			// 第四屏出场动画
			outAin:function(){
				var aboutItem1 = document.querySelector('#content .list .about .about3>.item:nth-child(1)');
				var aboutItem2 = document.querySelector('#content .list .about .about3>.item:nth-child(2)');
				
				aboutItem1.style.transform = 'rotateZ(30deg)';
				aboutItem2.style.transform = 'rotateZ(-30deg)';
			}
		},{
			// 第五屏入场动画
			inAin:function(){
				var team1 = document.querySelector('#content .list .team .team1');
				var team2 = document.querySelector('#content .list .team .team2');
				
				team1.style.transform = 'translateX(0)';
				team2.style.transform = 'translateX(0)';
			},
			// 第五屏出场动画
			outAin:function(){
				var team1 = document.querySelector('#content .list .team .team1');
				var team2 = document.querySelector('#content .list .team .team2');
				
				team1.style.transform = 'translateX(-100px)';
				team2.style.transform = 'translateX(100px)';
			}
		}];
		// 出场动画测试
		// animationArr[4]['outAin']();
		// setTimeout(function(){
		// 	animationArr[4]['inAin']();
		// },3000);
		
		// 出场动画初始化，一开始处于出场状态
		for(var i = 0; i < 5; i++){
			animationArr[i]['outAin']();
		}
		// 第一页的入场动画
		// setTimeout(function(){
			
		// },3000);
		
		
		// 侧边导航
		var barLi = document.querySelectorAll('#content .menuBar>li');
		
		function barFun(){
			for(var i = 0; i < barLi.length; i++){
				barLi[i].index = i;
				barLi[i].onclick = function(){
					for(var j = 0; j < barLi.length; j++){
						barLi[j].className = '';
					}
					barLi[this.index].className = 'active';
					preIndex = now;
					now = this.index;
					if(preIndex == now){
						return;
					}
					screenMove(now);
				}
			}
		}
		barFun();
		
		// 第一屏逻辑
		function home3D(){
			// 记录点击之前在哪页
			var oldIndex = 0;
			// 记录自动播放的索引值
			var autoIndex = 0;
			// 定义定时器
			var timer = null;
			// 给每一个小圆点添加点击事件
			for (var i = 0; i < home2Li.length; i++) {
				home2Li[i].index = i;
				home2Li[i].onclick = function(){
					// 点击时清除定时器，防止点击事件与定时器发生冲突
					clearInterval(timer);
					// 清除所有小圆点的active 然后给点击的小圆点添加active
					for(var j = 0; j < home2Li.length; j++){
						home2Li[j].className = '';
					}
					home2Li[this.index].className = 'active';
					// 根据oldIndex判断，点击右边的小圆点，左边的隐藏，右边的显示
					if(oldIndex < this.index){
						home1Li[oldIndex].className = 'leftHide';
						home1Li[this.index].className = 'rightShow';
					}else if(oldIndex > this.index){
						// 根据oldIndex判断，点击左边的小圆点，右边的隐藏，左边的显示
						home1Li[oldIndex].className = 'rightHide';
						home1Li[this.index].className = 'leftShow';
					}
					// 更新索引
					oldIndex = this.index;
					// 更新autoIndex，使定时器在点击之后从当前位置继续执行；
					autoIndex = this.index;
					//定时器继续执行
					autoPlay();
				}
			}
			function autoPlay(){
				timer = setInterval(function(){
					autoIndex++;
					// 判断临界值
					if(autoIndex == home2Li.length){
						autoIndex = 0;
					}
					// 主要内容一直向右侧翻
					home1Li[oldIndex].className = 'leftHide';
					home1Li[autoIndex].className = 'rightShow';
					// 更新小圆点
					for(var j = 0; j < home2Li.length; j++){
						home2Li[j].className = '';
					}
					home2Li[autoIndex].className = 'active';
					
					// 更新索引值
					oldIndex = autoIndex;
				},5000);
			}
			autoPlay();
		}
		// home3D();
		
		// 第四屏
		picBoom();
		function picBoom(){
			for(var i = 0; i < aboutUl.length; i++){
				changeImg(aboutUl[i]);
				
			}
			// 图片改变函数
			function changeImg(ul){
				// 所有li的宽高是ul宽高的一半
				var w = ul.offsetWidth/2;
				var h = ul.offsetHeight/2;
				// 获取ul的data-src属性
				var imgSrc = ul.dataset.src;
				// 创建li
				for(var i = 0 ; i < 4; i++){
					// 生成li节点
					var liNode = document.createElement('li');
					// 创建img节点
					var imgNode = new Image();
					
					liNode.style.width = w + 'px';
					liNode.style.height = h + 'px';
					// 加载图片
					imgNode.src = imgSrc;
					imgNode.style.left = -(i%2) * w + 'px';
					// 利用向下取整的数学方法，如下公式。第一第二张图片（i分别为0,1）的结果都为0，第三第四张图片（i分别为2,3）的结果都为-h；
					imgNode.style.top = -Math.floor(i/2)*h + 'px';
					ul.appendChild(liNode);
					liNode.appendChild(imgNode);
				}
				var imgNodes = ul.querySelectorAll('img');
				// 绑定鼠标移入移出事件
				ul.onmouseenter = function(){
					imgNodes[0].style.top = h + 'px';
					imgNodes[1].style.left = -2*w + 'px';
					imgNodes[2].style.left = w + 'px';
					imgNodes[3].style.top = -2*h + 'px';
				};
				ul.onmouseleave = function(){
					imgNodes[0].style.top = 0 + 'px';
					imgNodes[1].style.left = -w + 'px';
					imgNodes[2].style.left = 0 + 'px';
					imgNodes[3].style.top = -h + 'px';
				}
			}
		}
		
		// 滚轮滑动降频定时器
		var timer = null;
		
		//滚轮事件
		//兼容
		//ie/chrome
		document.onmousewheel = function(event){
			clearTimeout(timer);
			// 加定时器的目的为给鼠标滑动降频，（降低鼠标滑动的灵敏度）
			timer = setTimeout(function(){
				fun(event);
			},200);
		};
		//firefox
		if(document.addEventListener){
			document.addEventListener('DOMMouseScroll',function(event){
				clearTimeout(timer);
				timer = setTimeout(function(){
					fun(event);
				},200);
		});
		}
		
		function fun(event){
			event = event || window.event;
			//定义标记，记录滚轮滚动的方向
			var flag = '';
			//判断滚轮滚动方向
			if(event.wheelDelta){
				//ie/chrome
				if(event.wheelDelta > 0){
					//滚轮向上滑动
					flag = 'up';
				}else if(event.wheelDelta < 0){
					//滚轮向下滑动
					flag = 'down';
				}
			}else if(event.detail){
				//firefox
				if(event.detail < 0){
					//滚轮向上滑动
					flag = 'up';
				}else if(event.detail < 0){
					//滚轮向下滑动
					flag = 'down';
				}
			}
			preIndex = now;
			// 判断出场动画的临界值
			if((preIndex == 0 && flag == 'up') || (preIndex == liNodes.length-1 && flag == 'down')){
				return;
			}
			switch(flag){
				case 'up':
				// 执行向上的逻辑
					if(now > 0){
						now--;
					}
					screenMove(now);
					// barLiFun(now);
					break;
				case 'down':
				// 执行向下的逻辑
						if(now < liNodes.length - 1){
							now++;
						}
					screenMove(now);
					// barLiFun(now);
					break;
			}
			// 取消浏览器默认行为
			event.preventDefault && event.preventDefault();
			
			return false;
		}
		
		//主体布局
		function contentBind(){
			content.style.height = document.documentElement.clientHeight - header.offsetHeight + 'px';
			for(var i = 0; i < contentLi.length; i++){
				contentLi[i].style.height = document.documentElement.clientHeight - header.offsetHeight  + 'px';
			}
		}
		
		// 当窗口被拖动改变的时候
		window.onresize = function(){
			// 重新计算主题内容的高度
			contentBind();
			// 重新计算小三角根据当前页面的位置
			arrow.style.left = liNodes[now].getBoundingClientRect().left + liNodes[now].offsetWidth/2- arrow.offsetWidth/2  + 'px';
		}
		
		//头部布局
		function headerBind(){
			//第一个up的宽度
			upNodes[0].style.width = '100%';
			//初始化小三角的位置
			arrow.style.left = liNodes[0].getBoundingClientRect().left + liNodes[0].offsetWidth/2- arrow.offsetWidth/2  + 'px';
			for (var i = 0; i < liNodes.length; i++) {
				//给所有的li添加index属性
				liNodes[i].index = i;
				//给所有的li绑定单机事件
				liNodes[i].onclick = function () {
					//清空所有的up的宽度
					for (var j = 0; j < upNodes.length; j++) {
						upNodes[j].style.width = '';
			
					}
					upNodes[this.index].style.width = '100%';
					arrow.style.left = liNodes[this.index].getBoundingClientRect().left + liNodes[this.index].offsetWidth / 2 - arrow.offsetWidth / 2 + 'px';
					preIndex = now;
					now = this.index;
					if(preIndex == now){
						return;
					}
					screenMove(now);
				}
			}
		}
		
		
		
		headerBind();
		contentBind();
		screenMove();
		
		// 屏幕滑动函数
		function screenMove(now){
			// 导航部分：屏幕滚动到的区域对应的导航部分要高亮，小三角位置跟随移动
			// 1.导航up的宽度
			for (i = 0; i < upNodes.length; i++) {
				upNodes[i].style.width = '';
			}
			upNodes[now].style.width = '100%';
			// 小三角的位置改变
			arrow.style.left = liNodes[now].getBoundingClientRect().left + liNodes[now].offsetWidth / 2 - arrow.offsetWidth / 2 + 'px';
			// 主体部分：页面的滚动是list的top值改变，所以也要更改
			// 屏幕切换  当前在第几屏 * （视口高度-header高度）；
			contentList.style.top = -now * (document.documentElement.clientHeight - header.offsetHeight)  + 'px';
			for(var i = 0; i < barLi.length; i++){
				barLi[i].className = '';
			}
			barLi[now].className = 'active';
			// 给当前页加入场动画
			animationArr[now]['inAin']();
			// 给翻过去的那一页加出场动画
			animationArr[preIndex]['outAin']();
		}
	}
</script>


</body>
</html>